# Self-Supervised Image Classification Configuration

# Model Architecture
model:
  feature_dim: 256
  num_classes: 10

# Dataset
data:
  data_dir: './dataset'
  batch_size: 128
  num_workers: 4

# Training
training:
  num_iterations: 10           # Number of iterative refinement cycles
  epochs_per_iteration: 50     # Epochs to train classifier per iteration
  recluster_interval: 10       # Re-cluster every N epochs (null to disable)
  learning_rate: 0.001
  weight_decay: 0.0001
  optimizer: 'adam'            # adam or sgd

# Clustering
clustering:
  n_clusters: 10
  use_gpu_clustering: true     # Use FAISS if available
  max_iter: 300                # K-means max iterations
  n_init: 20                   # K-means number of initializations

# Convergence
convergence:
  label_stability_threshold: 0.95   # Stop if pseudo-label stability exceeds this
  early_stopping: true              # Enable early stopping

# Optional: Autoencoder Pre-training
pretraining:
  enabled: false               # Enable autoencoder pre-training
  epochs: 50
  learning_rate: 0.001

# Evaluation
evaluation:
  eval_every_iteration: true   # Evaluate on test set after each iteration
  save_best_model: true        # Save model with best test accuracy
  compute_tsne: false          # Compute t-SNE visualization (slow)

# Paths
paths:
  checkpoint_dir: './checkpoints'
  results_dir: './results'
  logs_dir: './logs'

# Reproducibility
seed: 42

# Device
device: 'cuda'  # cuda or cpu
